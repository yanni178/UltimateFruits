
<script>
const produtos = [
  { nome: "Venom", preco: 10, img: "https://i.imgur.com/xRix2sP.png" },
  { nome: "Trex", preco: 9.5, img: "https://i.imgur.com/3YJ0p6t.png" },
  { nome: "Shadow", preco: 8, img: "https://i.imgur.com/vcZ0Qqg.png" },
  { nome: "Yeti", preco: 13.5, img: "https://i.imgur.com/BOjQnPX.png" }
];

let carrinho = JSON.parse(localStorage.getItem("carrinho")) || {};

function salvar() {
  localStorage.setItem("carrinho", JSON.stringify(carrinho));
}

function renderProdutos() {
  const area = document.getElementById("produtos");
  area.innerHTML = "";

  produtos.forEach((p, i) => {
    area.innerHTML += `
      <div class="card">
        <img src="${p.img}">
        <h3>${p.nome}</h3>
        <p>R$ ${p.preco.toFixed(2)}</p>
        <button onclick="addProduto(${i})">Adicionar</button>
      </div>
    `;
  });
}

function addProduto(i) {
  const prod = produtos[i];

  if (!carrinho[prod.nome]) {
    carrinho[prod.nome] = { ...prod, qtd: 0 };
  }

  carrinho[prod.nome].qtd++;

  salvar();
  atualizarContador();
  abrirCarrinho(); // ðŸ”¥ abre automÃ¡tico
}

function atualizarContador() {
  let total = 0;
  Object.values(carrinho).forEach(p => total += p.qtd);
  document.getElementById("count").innerText = total;
}

function abrirCarrinho() {
  document.getElementById("modal").style.display = "flex";
  renderCarrinho();
}

function fecharCarrinho() {
  document.getElementById("modal").style.display = "none";
}

function renderCarrinho() {
  const lista = document.getElementById("lista");
  lista.innerHTML = "";

  let total = 0;

  Object.values(carrinho).forEach(p => {
    total += p.preco * p.qtd;

    lista.innerHTML += `
      <div class="item">
        ${p.nome} x${p.qtd}
        <div>
          <button class="qty-btn" onclick="diminuir('${p.nome}')">-</button>
          <button class="qty-btn" onclick="aumentar('${p.nome}')">+</button>
        </div>
      </div>
    `;
  });

  document.getElementById("total").innerText =
    "Total: R$ " + total.toFixed(2);
}

function aumentar(nome) {
  carrinho[nome].qtd++;
  salvar();
  atualizarContador();
  renderCarrinho();
}

function diminuir(nome) {
  carrinho[nome].qtd--;

  if (carrinho[nome].qtd <= 0) {
    delete carrinho[nome];
  }

  salvar();
  atualizarContador();
  renderCarrinho();
}

function limpar() {
  carrinho = {};
  salvar();
  atualizarContador();
  renderCarrinho();
}

function mostrarPix(v) {
  document.getElementById("pixArea").style.display =
    v === "pix" ? "block" : "none";
}

function finalizar() {
  if (Object.keys(carrinho).length === 0) {
    alert("Carrinho vazio!");
    return;
  }

  alert("âœ… Pedido criado! Pague no PIX.");
}

renderProdutos();
atualizarContador();
</script>
